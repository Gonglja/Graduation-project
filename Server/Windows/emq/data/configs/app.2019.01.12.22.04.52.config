[{emqx_web_hook,
  [{url,"http://127.0.0.1:8080"},
   {rules,
    [{"message.acked","{\"action\": \"on_message_acked\"}"},
     {"message.delivered","{\"action\": \"on_message_delivered\"}"},
     {"message.publish","{\"action\": \"on_message_publish\"}"},
     {"session.terminated","{\"action\": \"on_session_terminated\"}"},
     {"session.unsubscribed","{\"action\": \"on_session_unsubscribed\"}"},
     {"session.subscribed","{\"action\": \"on_session_subscribed\"}"},
     {"session.created","{\"action\": \"on_session_created\"}"},
     {"client.unsubscribe","{\"action\": \"on_client_unsubscribe\"}"},
     {"client.subscribe","{\"action\": \"on_client_subscribe\"}"},
     {"client.disconnected","{\"action\": \"on_client_disconnected\"}"},
     {"client.connected","{\"action\": \"on_client_connected\"}"}]}]},
 {emqx_stomp,
  [{allow_anonymous,true},
   {listener,{61613,[{acceptors,4},{max_clients,512}]}},
   {default_user,[{login,"guest"},{passcode,"guest"}]},
   {frame,
    [{max_headers,10},{max_header_length,1024},{max_body_length,8192}]}]},
 {emqx_statsd,[{interval,15000},{push_gateway,"http://127.0.0.1:9091"}]},
 {emqx_sn,
  [{enable_qos3,false},
   {enable_stats,false},
   {idle_timeout,30000},
   {gateway_id,1},
   {advertise_duration,15000},
   {port,1884},
   {username,<<"mqtt_sn_user">>},
   {password,<<"abc">>},
   {predefined,
    [{1,<<"/predefined/topic/name/hello">>},
     {2,<<"/predefined/topic/name/nice">>}]}]},
 {emqx_retainer,
  [{expiry_interval,0},
   {max_payload_size,1048576},
   {max_retained_messages,0},
   {storage_type,ram}]},
 {emqx_reloader,[{logfile,"reloader.log"},{interval,60000}]},
 {emqx_recon,[{gc_interval,300000}]},
 {emqx_management,
  [{max_row_limit,10000},
   {listeners,
    [{http,8080,
      [{backlog,512},
       {send_timeout,15000},
       {send_timeout_close,true},
       {nodelay,true},
       {num_acceptors,2},
       {max_connections,512}]}]}]},
 {emqx_lwm2m,
  [{xml_dir,"etc/lwm2m_xml"},
   {certfile,"etc/certs/cert.pem"},
   {keyfile,"etc/certs/key.pem"},
   {auto_observe,false},
   {qmode_time_window,0},
   {lifetime_max,86400},
   {lifetime_min,1},
   {port,5683},
   {options,
    [{lb,undefined},
     {opts,
      [{read_packets,20},
       {sndbuf,1048576},
       {recbuf,1048576},
       {buffer,1048576}]}]},
   {topics,
    [{update,"lwm2m/%e/up/resp"},
     {register,"lwm2m/%e/up/resp"},
     {notify,"lwm2m/%e/up/notify"},
     {response,"lwm2m/%e/up/resp"},
     {command,"lwm2m/%e/dn/#"}]}]},
 {emqx_dashboard,
  [{default_user_passwd,"public"},
   {default_user_username,"admin"},
   {api_providers,[emqx_management,emqx_dashboard]},
   {listeners,[{http,18083,[{num_acceptors,4},{max_connections,512}]}]}]},
 {emqx_coap,
  [{enable_stats,false},
   {certfile,"etc/certs/cert.pem"},
   {keyfile,"etc/certs/key.pem"},
   {keepalive,120},
   {port,5683}]},
 {emqx_auth_redis,
  [{acl_cmd,"HGETALL mqtt_acl:%u"},
   {super_cmd,"HGET mqtt_user:%u is_superuser"},
   {auth_cmd,"HMGET mqtt_user:%u password"},
   {server,
    [{pool_size,8},
     {auto_reconnect,1},
     {host,"127.0.0.1"},
     {port,6379},
     {database,0},
     {password,[]},
     {sentinel,[]}]},
   {password_hash,plain}]},
 {emqx_auth_pgsql,
  [{acl_query,
    "select allow, ipaddr, username, clientid, access, topic from mqtt_acl where ipaddr = '%a' or username = '%u' or username = '$all' or clientid = '%c'"},
   {super_query,
    "select is_superuser from mqtt_user where username = '%u' limit 1"},
   {auth_query,"select password from mqtt_user where username = '%u' limit 1"},
   {server,
    [{pool_size,8},
     {auto_reconnect,1},
     {host,"127.0.0.1"},
     {port,5432},
     {username,"root"},
     {password,[]},
     {database,"mqtt"},
     {encoding,utf8},
     {ssl,false},
     {ssl_opts,[]}]},
   {password_hash,sha256}]},
 {emqx_auth_mysql,
  [{acl_query,
    "select allow, ipaddr, username, clientid, access, topic from mqtt_acl where ipaddr = '%a' or username = '%u' or username = '$all' or clientid = '%c'"},
   {super_query,
    "select is_superuser from mqtt_user where username = '%u' limit 1"},
   {auth_query,"select password from mqtt_user where username = '%u' limit 1"},
   {server,
    [{pool_size,8},
     {auto_reconnect,1},
     {host,"127.0.0.1"},
     {port,3306},
     {user,[]},
     {password,[]},
     {database,"mqtt"},
     {encoding,utf8},
     {keep_alive,true}]},
   {password_hash,sha256}]},
 {emqx_auth_ldap,
  [{password_attr,"userPassword"},
   {username_attr,"uid"},
   {match_objectclass,"mqttUser"},
   {device_dn,"ou=device,dc=emqx,dc=io"},
   {ldap,
    [{ssl,false},
     {servers,["127.0.0.1"]},
     {port,389},
     {timeout,30000},
     {bind_dn,"cn=root,dc=emqx,dc=io"},
     {bind_password,"public"},
     {pool,8},
     {auto_reconnect,2}]}]},
 {emqx_auth_jwt,[{secret,"emqxsecret"}]},
 {emqx,
  [{route_batch_clean,false},
   {shared_dispatch_ack_enabled,false},
   {shared_subscription_strategy,random},
   {session_locking_strategy,quorum},
   {enable_session_registry,true},
   {broker_sys_interval,60000},
   {expand_plugins_dir,"plugins/"},
   {plugins_loaded_file,"data/loaded_plugins"},
   {plugins_etc_dir,"etc/plugins/"},
   {mqtt_ignore_loop_deliver,false},
   {mqtt_shared_subscription,true},
   {mqtt_wildcard_subscription,true},
   {mqtt_retain_available,true},
   {max_topic_alias,0},
   {max_qos_allowed,2},
   {max_topic_levels,0},
   {max_clientid_len,65535},
   {max_packet_size,1048576},
   {response_topic_prefix,"emqxrspv1"},
   {acl_deny_action,ignore},
   {acl_cache_max_size,32},
   {acl_cache_ttl,60000},
   {enable_acl_cache,true},
   {acl_file,"etc/acl.conf"},
   {acl_nomatch,allow},
   {allow_anonymous,true},
   {primary_log_level,error},
   {zones,
    [{external,
      [{use_username_as_clientid,false},
       {upgrade_qos,false},
       {session_expiry_interval,7200},
       {retry_interval,20000},
       {mqueue_store_qos0,true},
       none,
       {mqueue_default_priority,highest},
       {max_subscriptions,0},
       {max_mqueue_len,1000},
       {max_inflight,32},
       {max_awaiting_rel,100},
       {keepalive_backoff,0.75},
       {idle_timeout,15000},
       {force_shutdown_policy,#{max_heap_size => 0,message_queue_len => 0}},
       {force_gc_policy,#{bytes => 1048576,count => 1000}},
       {enable_stats,true},
       {enable_ban,true},
       {enable_acl,true},
       {await_rel_timeout,300000},
       {acl_deny_action,ignore}]},
     {internal,
      [{use_username_as_clientid,false},
       {upgrade_qos,false},
       {session_expiry_interval,7200},
       {retry_interval,20000},
       {mqueue_store_qos0,true},
       none,
       {mqueue_default_priority,lowest},
       {max_subscriptions,0},
       {max_mqueue_len,1000},
       {max_inflight,32},
       {max_awaiting_rel,100},
       {keepalive_backoff,0.75},
       {idle_timeout,15000},
       {force_shutdown_policy,#{max_heap_size => 0,message_queue_len => 0}},
       {force_gc_policy,#{bytes => 0,count => 0}},
       {enable_stats,true},
       {enable_ban,false},
       {enable_acl,false},
       {await_rel_timeout,300000},
       {allow_anonymous,true},
       {acl_deny_action,ignore}]}]},
   {listeners,
    [{tcp,
      {"127.0.0.1",11883},
      [{tcp_options,
        [{backlog,512},
         {send_timeout,5000},
         {send_timeout_close,true},
         {nodelay,false},
         {reuseaddr,true}]},
       {acceptors,4},
       {max_connections,1024000},
       {max_conn_rate,1000},
       {active_n,1000},
       {zone,internal}]},
     {tcp,
      {"0.0.0.0",1883},
      [{tcp_options,
        [{backlog,1024},
         {send_timeout,15000},
         {send_timeout_close,true},
         {nodelay,true},
         {reuseaddr,true}]},
       {acceptors,8},
       {max_connections,1024000},
       {max_conn_rate,1000},
       {active_n,100},
       {zone,external},
       {access_rules,[{allow,all}]}]},
     {ws,8083,
      [{tcp_options,
        [{backlog,1024},
         {send_timeout,15000},
         {send_timeout_close,true},
         {nodelay,true}]},
       {acceptors,4},
       {mqtt_path,"/mqtt"},
       {max_connections,102400},
       {max_conn_rate,1000},
       {zone,external},
       {verify_protocol_header,true},
       {access_rules,[{allow,all}]}]},
     {ssl,8883,
      [{tcp_options,
        [{backlog,1024},
         {send_timeout,15000},
         {send_timeout_close,true},
         {nodelay,true},
         {reuseaddr,true}]},
       {ssl_options,
        [{ciphers,
          ["ECDHE-ECDSA-AES256-GCM-SHA384","ECDHE-RSA-AES256-GCM-SHA384",
           "ECDHE-ECDSA-AES256-SHA384","ECDHE-RSA-AES256-SHA384",
           "ECDHE-ECDSA-DES-CBC3-SHA","ECDH-ECDSA-AES256-GCM-SHA384",
           "ECDH-RSA-AES256-GCM-SHA384","ECDH-ECDSA-AES256-SHA384",
           "ECDH-RSA-AES256-SHA384","DHE-DSS-AES256-GCM-SHA384",
           "DHE-DSS-AES256-SHA256","AES256-GCM-SHA384","AES256-SHA256",
           "ECDHE-ECDSA-AES128-GCM-SHA256","ECDHE-RSA-AES128-GCM-SHA256",
           "ECDHE-ECDSA-AES128-SHA256","ECDHE-RSA-AES128-SHA256",
           "ECDH-ECDSA-AES128-GCM-SHA256","ECDH-RSA-AES128-GCM-SHA256",
           "ECDH-ECDSA-AES128-SHA256","ECDH-RSA-AES128-SHA256",
           "DHE-DSS-AES128-GCM-SHA256","DHE-DSS-AES128-SHA256",
           "AES128-GCM-SHA256","AES128-SHA256","ECDHE-ECDSA-AES256-SHA",
           "ECDHE-RSA-AES256-SHA","DHE-DSS-AES256-SHA",
           "ECDH-ECDSA-AES256-SHA","ECDH-RSA-AES256-SHA","AES256-SHA",
           "ECDHE-ECDSA-AES128-SHA","ECDHE-RSA-AES128-SHA",
           "DHE-DSS-AES128-SHA","ECDH-ECDSA-AES128-SHA","ECDH-RSA-AES128-SHA",
           "AES128-SHA"]},
         {handshake_timeout,15000},
         {keyfile,"etc/certs/key.pem"},
         {certfile,"etc/certs/cert.pem"},
         {reuse_sessions,true}]},
       {acceptors,16},
       {max_connections,102400},
       {max_conn_rate,500},
       {active_n,100},
       {zone,external},
       {access_rules,[{allow,all}]}]},
     {wss,8084,
      [{tcp_options,
        [{backlog,1024},
         {send_timeout,15000},
         {send_timeout_close,true},
         {nodelay,true}]},
       {ssl_options,
        [{ciphers,
          ["ECDHE-ECDSA-AES256-GCM-SHA384","ECDHE-RSA-AES256-GCM-SHA384",
           "ECDHE-ECDSA-AES256-SHA384","ECDHE-RSA-AES256-SHA384",
           "ECDHE-ECDSA-DES-CBC3-SHA","ECDH-ECDSA-AES256-GCM-SHA384",
           "ECDH-RSA-AES256-GCM-SHA384","ECDH-ECDSA-AES256-SHA384",
           "ECDH-RSA-AES256-SHA384","DHE-DSS-AES256-GCM-SHA384",
           "DHE-DSS-AES256-SHA256","AES256-GCM-SHA384","AES256-SHA256",
           "ECDHE-ECDSA-AES128-GCM-SHA256","ECDHE-RSA-AES128-GCM-SHA256",
           "ECDHE-ECDSA-AES128-SHA256","ECDHE-RSA-AES128-SHA256",
           "ECDH-ECDSA-AES128-GCM-SHA256","ECDH-RSA-AES128-GCM-SHA256",
           "ECDH-ECDSA-AES128-SHA256","ECDH-RSA-AES128-SHA256",
           "DHE-DSS-AES128-GCM-SHA256","DHE-DSS-AES128-SHA256",
           "AES128-GCM-SHA256","AES128-SHA256","ECDHE-ECDSA-AES256-SHA",
           "ECDHE-RSA-AES256-SHA","DHE-DSS-AES256-SHA",
           "ECDH-ECDSA-AES256-SHA","ECDH-RSA-AES256-SHA","AES256-SHA",
           "ECDHE-ECDSA-AES128-SHA","ECDHE-RSA-AES128-SHA",
           "DHE-DSS-AES128-SHA","ECDH-ECDSA-AES128-SHA","ECDH-RSA-AES128-SHA",
           "AES128-SHA"]},
         {keyfile,"etc/certs/key.pem"},
         {certfile,"etc/certs/cert.pem"},
         {reuse_sessions,true}]},
       {acceptors,4},
       {mqtt_path,"/mqtt"},
       {max_connections,16},
       {max_conn_rate,1000},
       {zone,external},
       {verify_protocol_header,true},
       {access_rules,[{allow,all}]}]}]},
   {bridges,
    [{aws,
      [{username,"user"},
       {address,"127.0.0.1:1883"},
       {clean_start,true},
       {client_id,"bridge_aws"},
       {forwards,["topic1/#","topic2/#"]},
       {keepalive,60000},
       {max_pending_messages,10000},
       {mountpoint,"bridge/aws/${node}/"},
       {mqueue_type,memory},
       {password,"passwd"},
       {proto_ver,mqttv4},
       {reconnect_interval,30000},
       {ssl,false},
       {ssl_opts,[{versions,[tlsv1,'tlsv1.1','tlsv1.2']}]},
       {start_type,manual},
       {subscriptions,[{"cmd/topic1",1},{"cmd/topic2",1}]}]}]},
   {modules,[{emqx_mod_presence,[{qos,1}]}]},
   {sysmon,
    [{long_gc,false},
     {long_schedule,240},
     {large_heap,8388608},
     {busy_port,false},
     {busy_dist_port,true}]}]},
 {kernel,
  [{error_logger,silent},
   {logger_sasl_compatible,true},
   {inet_dist_listen_max,6369},
   {inet_dist_listen_min,6369},
   {logger,
    [{handler,default,logger_std_h,
      #{config => #{type => standard_io},
        formatter =>
         {emqx_logger_formatter,
          #{template =>
             [time," [",level,"] ",
              {client_id,
               [{peername,[client_id,"@",peername," "],[client_id," "]}],
               [{peername,[peername," "],[]}]},
              msg,"\n"]}},
        level => error}},
     {handler,file,logger_disk_log_h,
      #{config =>
         #{file => "log/emqx.log",max_no_bytes => 10485760,max_no_files => 5,
           type => wrap},
        filesync_repeat_interval => no_repeat,
        formatter =>
         {emqx_logger_formatter,
          #{template =>
             [time," [",level,"] ",
              {client_id,
               [{peername,[client_id,"@",peername," "],[client_id," "]}],
               [{peername,[peername," "],[]}]},
              msg,"\n"]}},
        level => error}}]}]},
 {sasl,[{sasl_error_logger,false}]},
 {gen_rpc,
  [{socket_keepalive_count,9},
   {socket_keepalive_interval,75},
   {socket_keepalive_idle,900},
   {call_receive_timeout,15000},
   {authentication_timeout,5000},
   {send_timeout,5000},
   {connect_timeout,5000},
   {tcp_client_port,5369},
   {tcp_server_port,5369}]},
 {ekka,
  [{cluster_autoheal,true},
   {cluster_autoclean,300000},
   {cluster_name,emqxcl},
   {cluster_enable,true},
   {cluster_discovery,{manual,[]}}]},
 {emqx_auth_http,
  [{auth_req,
    [{url,"http://127.0.0.1:8991/mqtt/auth"},
     {method,post},
     {params,[{"clientid","%c"},{"username","%u"},{"password","%P"}]}]},
   {super_req,
    [{url,"http://127.0.0.1:8991/mqtt/superuser"},
     {method,post},
     {params,[{"clientid","%c"},{"username","%u"}]}]},
   {acl_req,
    [{url,"http://127.0.0.1:8991/mqtt/acl"},
     {method,get},
     {params,
      [{"access","%A"},
       {"username","%u"},
       {"clientid","%c"},
       {"ipaddr","%a"},
       {"topic","%t"}]}]}]},
 {emqx_auth_mongo,
  [{server,
    [{type,single},
     {hosts,["127.0.0.1:27017"]},
     {options,[{pool_size,1},{max_overflow,0}]},
     {worker_options,[{database,<<"mqtt">>},{auth_source,<<"mqtt">>}]},
     {auto_reconnect,1},
     {pool_size,8}]},
   {auth_query,
    [{collection,"mqtt_user"},
     {password_field,[<<"password">>]},
     {password_hash,sha256},
     {selector,[{<<"username">>,<<"%u">>}]}]},
   {super_query,
    [{collection,"mqtt_user"},
     {super_field,"is_superuser"},
     {selector,[{<<"username">>,<<"%u">>}]}]},
   {acl_query,
    [{collection,"mqtt_acl"},{selector,[[{<<"username">>,<<"%u">>}]]}]}]}].
